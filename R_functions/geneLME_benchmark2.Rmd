---
title: "geneLME Benchmarking v2"
subtitle: "Sign consistency vs kimma | Speed comparison | Accuracy"
date: "`r Sys.Date()`"
output:
  html_document:
    toc: true
    toc_float:
      collapsed: false
      smooth_scroll: true
    toc_depth: 3
    theme: flatly
    highlight: tango
    code_folding: hide
    df_print: paged
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo      = TRUE,
  message   = FALSE,
  warning   = FALSE,
  comment   = "#>",
  fig.align = "center",
  fig.width = 8,
  fig.height = 5
)
```

---

# Overview

This report benchmarks `geneLME.R` (current stable, incorporating all dev2 changes)
against `kimma::kmFit` across three analyses:

1. **Sign consistency:** Direction-aware join between geneLME and kimma contrast estimates.
   Identifies same-direction vs flipped-direction pairs; verifies numerical agreement
   after sign correction.

2. **Speed comparison:** `microbenchmark` (5 reps each) on 2,000 genes comparing
   geneLME at 3, 6, and 66 contrasts against kimma's default 66-contrast run.

3. **Summary:** Key metrics from both analyses in one place.

**geneLME.R features (as of 2026-02-20 merge):**

| Feature | Details |
|---|---|
| Singular fit handling | `model_status = "singular_fit"` flag; results returned for all genes |
| Branch A contrast build | Pre-computed once before parallel stage (`geneLME_build_contrast_args()`) |
| Warning suppression | Package startup messages + rescaling warnings silenced |
| Parallel plan | `future::plan(future::multisession)` / `future::plan(future::sequential)` |

---

# Setup

```{r libs}
library(lme4)
library(emmeans)
library(car)
library(broom.mixed)
library(dplyr)
library(tibble)
library(purrr)
library(future)
library(future.apply)
library(kimma)
library(microbenchmark)
library(ggplot2)
library(tidyr)
library(scales)
library(knitr)
library(gridExtra)
```

```{r source-functions}
source("geneLME.R")
cat("Sourced: geneLME.R\n")
```

---

# Mock Data

Same design as v1 benchmark: 10 patients × 3 treatments × 4 visits = 120 samples.
Full dataset = 2,000 genes; accuracy subset = 50 genes.
Genes 1–100 have a simulated TrtC:V3 +2.5 log2 effect.

```{r mock-data}
set.seed(42)

n_patients <- 10
treatments <- c("TrtA", "TrtB", "TrtC")
visits     <- c("V1", "V2", "V3", "V4")
n_genes    <- 2000
n_signal   <- 100

patient_meta <- data.frame(
  ptID = paste0("pt", sprintf("%02d", 1:n_patients)),
  sex  = factor(sample(c("M", "F"), n_patients, replace = TRUE)),
  age  = round(rnorm(n_patients, mean = 38, sd = 10)),
  stringsAsFactors = FALSE
)

targets <- expand.grid(
  ptID      = paste0("pt", sprintf("%02d", 1:n_patients)),
  treatment = treatments,
  visit     = visits,
  stringsAsFactors = FALSE
) %>%
  arrange(ptID, treatment, visit) %>%
  left_join(patient_meta, by = "ptID") %>%
  mutate(
    sample_id    = paste(ptID, treatment, visit, sep = "_"),
    libID        = sample_id,
    rNANgUl      = rnorm(n(), mean = 5,    sd = 1),
    lib.size     = round(rnorm(n(), mean = 20e6, sd = 3e6)),
    norm.factors = rnorm(n(), mean = 1,    sd = 0.05)
  )
rownames(targets) <- targets$sample_id
n_samples <- nrow(targets)

E_mat <- matrix(
  rnorm(n_genes * n_samples, mean = 8, sd = 2),
  nrow = n_genes, ncol = n_samples,
  dimnames = list(
    paste0("gene", sprintf("%04d", 1:n_genes)),
    targets$sample_id
  )
)

trtC_v3 <- which(targets$treatment == "TrtC" & targets$visit == "V3")
E_mat[1:n_signal, trtC_v3] <- E_mat[1:n_signal, trtC_v3] + 2.5

for (pt in unique(targets$ptID)) {
  idx <- which(targets$ptID == pt)
  E_mat[, idx] <- E_mat[, idx] + rnorm(1, 0, 1)
}

W_mat <- matrix(
  abs(rnorm(n_genes * n_samples, mean = 1, sd = 0.1)),
  nrow = n_genes, ncol = n_samples,
  dimnames = dimnames(E_mat)
)

dat_bench <- list(E = E_mat, weights = W_mat, targets = targets)
dat_50    <- list(E = E_mat[1:50, ], weights = W_mat[1:50, ], targets = targets)

cat("Design:", n_patients, "patients ×", length(treatments), "treatments ×",
    length(visits), "visits =", n_samples, "samples\n")
cat("Full dataset:", n_genes, "genes | Accuracy subset: 50 genes\n")
cat("Signal genes (TrtC:V3 +2.5 log2):", n_signal, "\n")
```

---

# Contrast Specifications

```{r contrast-specs}
spec_full <- geneLME_contrast_spec(targets, contrast_vars = "treatment:visit")

spec_6 <- spec_full %>%
  filter(
    sub(".* ", "", contrast_ref) == sub(".* ", "", contrast_lvl),
    sub(".* ", "", contrast_ref) %in% c("V2", "V3")
  )

spec_3 <- spec_full %>%
  filter(
    sub(" .*", "", contrast_ref) == sub(" .*", "", contrast_lvl),
    sub(".* ", "", contrast_ref) == "V2",
    sub(".* ", "", contrast_lvl) == "V3"
  )

cat("spec_3  (longitudinal V2→V3, same treatment):         ", nrow(spec_3),  "contrasts\n")
cat("spec_6  (between-treatment, V2 & V3):                 ", nrow(spec_6),  "contrasts\n")
cat("spec_full (all pairwise):                             ", nrow(spec_full), "contrasts\n")
```

---

# 1. Sign Consistency: geneLME vs kimma

## 1a. Run both methods (50 genes, 66 contrasts)

```{r accuracy-run, cache=TRUE}
# --- geneLME ---
res_glme <- geneLME(
  dat           = dat_50,
  formula_str   = "~ treatment * visit + age + sex + rNANgUl + (1|ptID)",
  model_weights = TRUE,
  run_contrast  = TRUE,
  contrast_vars = "treatment:visit",
  contrast_spec = spec_full,
  n_cores       = 8
)

cat("geneLME model status summary:\n")
print(table(res_glme$lme_err))

# --- kimma ---
res_kimma <- suppressMessages(
  kmFit(
    dat          = dat_50,
    run_lme      = TRUE,
    use_weights  = TRUE,
    model        = "~ treatment * visit + age + sex + rNANgUl + (1|ptID)",
    run_contrast = TRUE,
    contrast_var = "treatment:visit",
    patientID    = "ptID",
    libraryID    = "libID",
    processors   = 8
  )
)

cat("kimma genes in contrast output:",
    length(unique(res_kimma$lme.contrast$gene)), "/ 50\n")
```

## 1b. Inspect raw contrast direction columns

Before joining, we examine the direction columns from each method.
Note: **kimma has no `contrast` string column** — direction is encoded entirely
in `contrast_ref` and `contrast_lvl`. Also note that kimma's `statistic` column
is the **negated** t-statistic (`–estimate/SE`), i.e. opposite sign to `estimate`.
To compare against geneLME's `t.ratio`, we use `-statistic`.

```{r sign-inspect}
# geneLME: contrast string is "lvl - ref" (set by us via the named contrast vector)
glme_contrast_names <- res_glme$lme_contrast %>%
  filter(contrast_order == "first_order") %>%
  distinct(contrast, contrast_ref, contrast_lvl) %>%
  arrange(contrast_ref, contrast_lvl)

cat("geneLME — sample contrast name strings (first 10):\n")
print(head(glme_contrast_names, 10))

# kimma: no 'contrast' column — only contrast_ref and contrast_lvl
km_contrast_names <- res_kimma$lme.contrast %>%
  distinct(contrast_ref, contrast_lvl) %>%
  mutate(contrast_key_km = paste(contrast_lvl, contrast_ref, sep = " - ")) %>%
  arrange(contrast_ref, contrast_lvl)

cat("\nkimma — direction pairs (ref → lvl), first 10:\n")
print(head(km_contrast_names, 10))

# For each unique (ref, lvl) pair, check if kimma has it in the same or opposite
# orientation using a canonical sorted-pair key.
glme_pairs <- glme_contrast_names %>%
  select(contrast_ref, contrast_lvl) %>%
  mutate(canonical = paste(pmin(contrast_ref, contrast_lvl),
                           pmax(contrast_ref, contrast_lvl), sep = "|||"),
         glme_dir  = paste(contrast_ref, contrast_lvl, sep = "->"))

km_pairs <- km_contrast_names %>%
  select(contrast_ref, contrast_lvl) %>%
  mutate(canonical = paste(pmin(contrast_ref, contrast_lvl),
                           pmax(contrast_ref, contrast_lvl), sep = "|||"),
         km_dir    = paste(contrast_ref, contrast_lvl, sep = "->"))

pair_compare <- inner_join(glme_pairs, km_pairs, by = "canonical") %>%
  mutate(direction_agree = glme_dir == km_dir)

n_agree        <- sum(pair_compare$direction_agree)
n_flip         <- sum(!pair_compare$direction_agree)
n_total_pairs  <- nrow(pair_compare)

cat(sprintf("\nUnique contrast pairs found in both methods: %d\n", n_total_pairs))
cat(sprintf("Direction agrees (same ref→lvl):     %d / %d\n", n_agree, n_total_pairs))
cat(sprintf("Direction flipped (kimma swapped):   %d / %d\n", n_flip,  n_total_pairs))
```

## 1c. Direction-aware join

We join on `(gene, contrast_ref, contrast_lvl)`, then also attempt a flipped join
`(gene, contrast_ref = kimma$contrast_lvl, contrast_lvl = kimma$contrast_ref)` to
catch any pairs where kimma assigned the opposite direction. Sign-correction is
applied to flipped pairs before combining.

```{r sign-join}
glme_std <- res_glme$lme_contrast %>%
  filter(contrast_order == "first_order", !is.na(estimate)) %>%
  select(gene,
         contrast_ref_glme = contrast_ref,
         contrast_lvl_glme = contrast_lvl,
         estimate_glme     = estimate,
         t_glme            = t.ratio,
         p_glme            = p.value)

# kimma's 'statistic' column is the NEGATED t-statistic: statistic = –(estimate / SE).
# To get a signed t comparable to geneLME's t.ratio, negate statistic.
km_std <- res_kimma$lme.contrast %>%
  mutate(t_signed = -statistic) %>%
  select(gene,
         contrast_ref_km = contrast_ref,
         contrast_lvl_km = contrast_lvl,
         estimate_kimma  = estimate,
         t_kimma         = t_signed,
         p_kimma         = pval)

# Forward join: same direction
joined_fwd <- inner_join(
  glme_std, km_std,
  by = c("gene",
         "contrast_ref_glme" = "contrast_ref_km",
         "contrast_lvl_glme" = "contrast_lvl_km")
) %>% mutate(direction = "same")

# Flipped join: kimma has ref/lvl swapped relative to geneLME
joined_flip <- inner_join(
  glme_std, km_std,
  by = c("gene",
         "contrast_ref_glme" = "contrast_lvl_km",
         "contrast_lvl_glme" = "contrast_ref_km")
) %>%
  mutate(
    direction      = "flipped",
    estimate_kimma = -estimate_kimma,
    t_kimma        = -t_kimma
  )

joined_all <- bind_rows(joined_fwd, joined_flip)

cat("Rows joined (same direction):   ", nrow(joined_fwd),  "\n")
cat("Rows joined (flipped direction):", nrow(joined_flip), "\n")
cat("Total matched rows:             ", nrow(joined_all),  "\n")
cat("Unique genes in comparison:     ", length(unique(joined_all$gene)), "\n")

cat("\nDirection summary across all gene × contrast pairs:\n")
print(table(joined_all$direction))
```

## 1d. Estimate correlation plots

```{r sign-scatter-full, fig.height=5, fig.width=10}
cor_all  <- cor(joined_all$estimate_glme, joined_all$estimate_kimma, use = "complete.obs")
mad_all  <- mean(abs(joined_all$estimate_glme - joined_all$estimate_kimma), na.rm = TRUE)

cor_fwd  <- cor(joined_fwd$estimate_glme, joined_fwd$estimate_kimma, use = "complete.obs")
cor_flip <- if (nrow(joined_flip) > 0) {
  cor(joined_flip$estimate_glme, joined_flip$estimate_kimma, use = "complete.obs")
} else {
  NA_real_
}

p1 <- ggplot(joined_all, aes(x = estimate_glme, y = estimate_kimma, colour = direction)) +
  geom_point(alpha = 0.2, size = 0.8) +
  geom_abline(slope = 1, intercept = 0, colour = "firebrick",
              linewidth = 0.8, linetype = "dashed") +
  scale_colour_manual(values = c("same" = "#2c7bb6", "flipped" = "#d7191c")) +
  annotate("text", x = -Inf, y = Inf, hjust = -0.1, vjust = 1.4,
           label = sprintf("r = %.6f\nMAD = %.2e", cor_all, mad_all),
           size = 3.5, family = "mono") +
  labs(
    title    = "Contrast estimates after direction-aware join",
    subtitle = sprintf("All matched pairs (n = %d) | blue = same direction, red = flipped",
                       nrow(joined_all)),
    x = "geneLME estimate", y = "kimma estimate (sign-corrected)",
    colour = "Direction"
  ) +
  theme_bw(base_size = 12) +
  theme(legend.position = "bottom")

p2 <- ggplot(joined_all, aes(x = t_glme, y = t_kimma, colour = direction)) +
  geom_point(alpha = 0.2, size = 0.8) +
  geom_abline(slope = 1, intercept = 0, colour = "firebrick",
              linewidth = 0.8, linetype = "dashed") +
  scale_colour_manual(values = c("same" = "#1a9641", "flipped" = "#d7191c")) +
  labs(
    title    = "t-statistics after direction-aware join",
    subtitle = sprintf("All matched pairs (n = %d)", nrow(joined_all)),
    x = "geneLME t.ratio", y = "kimma statistic (sign-corrected)",
    colour = "Direction"
  ) +
  theme_bw(base_size = 12) +
  theme(legend.position = "bottom")

gridExtra::grid.arrange(p1, p2, ncol = 2)
```

```{r sign-scatter-naive, fig.height=5, fig.width=10}
# For reference: naive forward-only join and same-direction subset
cor_naive <- cor(joined_fwd$estimate_glme, joined_fwd$estimate_kimma, use = "complete.obs")
mad_naive <- mean(abs(joined_fwd$estimate_glme - joined_fwd$estimate_kimma), na.rm = TRUE)

p3 <- ggplot(joined_fwd, aes(x = estimate_glme, y = estimate_kimma)) +
  geom_point(alpha = 0.2, size = 0.8, colour = "#2c7bb6") +
  geom_abline(slope = 1, intercept = 0, colour = "firebrick",
              linewidth = 0.8, linetype = "dashed") +
  annotate("text", x = -Inf, y = Inf, hjust = -0.1, vjust = 1.4,
           label = sprintf("r = %.6f\nMAD = %.2e\nn = %d",
                           cor_naive, mad_naive, nrow(joined_fwd)),
           size = 3.5, family = "mono") +
  labs(
    title    = "Same-direction pairs only (ref/lvl agree)",
    x = "geneLME estimate", y = "kimma estimate"
  ) +
  theme_bw(base_size = 12)

p4 <- ggplot(joined_all, aes(x = estimate_glme, y = estimate_kimma)) +
  geom_point(alpha = 0.2, size = 0.8, colour = "#2c7bb6") +
  geom_abline(slope = 1, intercept = 0, colour = "firebrick",
              linewidth = 0.8, linetype = "dashed") +
  annotate("text", x = -Inf, y = Inf, hjust = -0.1, vjust = 1.4,
           label = sprintf("r = %.6f\nMAD = %.2e\nn = %d",
                           cor_all, mad_all, nrow(joined_all)),
           size = 3.5, family = "mono") +
  labs(
    title    = "All pairs after direction correction",
    x = "geneLME estimate", y = "kimma estimate (sign-corrected)"
  ) +
  theme_bw(base_size = 12)

gridExtra::grid.arrange(p3, p4, ncol = 2)
```

## 1e. Sign consistency summary

```{r sign-summary}
kable(
  data.frame(
    Metric  = c(
      "Total gene × contrast pairs joined",
      "Same direction (ref/lvl agree)",
      "Flipped direction (kimma has ref/lvl swapped)",
      "% pairs with direction agreement",
      "Estimate r (direction-corrected)",
      "Estimate MAD (direction-corrected)",
      "t-statistic r (direction-corrected)"
    ),
    Value = c(
      nrow(joined_all),
      nrow(joined_fwd),
      nrow(joined_flip),
      sprintf("%.1f%%", 100 * nrow(joined_fwd) / nrow(joined_all)),
      sprintf("%.8f", cor_all),
      sprintf("%.2e", mad_all),
      sprintf("%.8f", cor(joined_all$t_glme, joined_all$t_kimma, use = "complete.obs"))
    )
  ),
  col.names = c("Metric", "Value"),
  caption = "Sign consistency summary: geneLME vs kimma (50 genes, 66 contrasts)"
)
```

> **Interpretation:** When kimma and geneLME assign the same direction to a contrast pair,
> estimates should be numerically identical (both use `lme4` + `emmeans`). Flipped pairs
> reflect a difference in which cell was designated as "reference" — after sign-correction
> the numerical values should agree equally well. The proportion of flipped pairs reveals
> how often kimma's internal direction assignment differs from `geneLME`'s `contrast_spec`
> ordering.

---

# 2. Speed Comparison: geneLME vs kimma

## 2a. Microbenchmark (2,000 genes, 5 reps)

```{r bench-speed-glme, cache=TRUE}
cat("Running geneLME microbenchmark (5 reps each — this will take several minutes)...\n")

mb_glme <- microbenchmark(

  glme_3  = geneLME(
    dat = dat_bench, formula_str = "~ treatment * visit + age + sex + rNANgUl + (1|ptID)",
    model_weights = TRUE, run_contrast = TRUE,
    contrast_vars = "treatment:visit", contrast_spec = spec_3, n_cores = 8
  ),
  glme_6  = geneLME(
    dat = dat_bench, formula_str = "~ treatment * visit + age + sex + rNANgUl + (1|ptID)",
    model_weights = TRUE, run_contrast = TRUE,
    contrast_vars = "treatment:visit", contrast_spec = spec_6, n_cores = 8
  ),
  glme_66 = geneLME(
    dat = dat_bench, formula_str = "~ treatment * visit + age + sex + rNANgUl + (1|ptID)",
    model_weights = TRUE, run_contrast = TRUE,
    contrast_vars = "treatment:visit", contrast_spec = spec_full, n_cores = 8
  ),

  times = 5, unit = "sec"
)

print(summary(mb_glme))
```

```{r bench-speed-kimma, cache=TRUE}
cat("Running kimma microbenchmark (5 reps, 66 contrasts)...\n")

mb_kimma <- microbenchmark(
  kimma_66 = suppressMessages(kmFit(
    dat = dat_bench, run_lme = TRUE, use_weights = TRUE,
    model = "~ treatment * visit + age + sex + rNANgUl + (1|ptID)",
    run_contrast = TRUE, contrast_var = "treatment:visit",
    patientID = "ptID", libraryID = "libID", processors = 8
  )),
  times = 5, unit = "sec"
)

print(summary(mb_kimma))
```

## 2b. Speed comparison plots

```{r bench-plot-combined, fig.height=5, fig.width=10}
sum_glme <- summary(mb_glme) %>% as.data.frame() %>%
  mutate(
    version     = "geneLME.R",
    n_contrasts = c(3, 6, 66),
    label       = paste0("geneLME\n(", n_contrasts, " contrasts)")
  )

sum_kimma <- summary(mb_kimma) %>% as.data.frame() %>%
  mutate(
    version     = "kimma::kmFit",
    n_contrasts = 66,
    label       = "kimma\n(66 contrasts)"
  )

bench_all <- bind_rows(sum_glme, sum_kimma) %>%
  mutate(label = factor(label, levels = c(
    "geneLME\n(3 contrasts)",
    "geneLME\n(6 contrasts)",
    "geneLME\n(66 contrasts)",
    "kimma\n(66 contrasts)"
  )))

pal <- c("geneLME.R"    = "#2c7bb6",
         "kimma::kmFit" = "#d7191c")

ggplot(bench_all, aes(x = label, y = median, fill = version, colour = version)) +
  geom_col(alpha = 0.75, width = 0.6) +
  geom_errorbar(aes(ymin = lq, ymax = uq), width = 0.25, linewidth = 0.7) +
  scale_fill_manual(values   = pal) +
  scale_colour_manual(values = pal) +
  labs(
    title    = "Runtime comparison: geneLME vs kimma (2,000 genes, 5 reps)",
    subtitle = "Error bars = lower / upper quartile | geneLME shown at 3, 6, and 66 contrasts",
    x = NULL, y = "Median runtime (seconds)",
    fill = "Method", colour = "Method"
  ) +
  theme_bw(base_size = 12) +
  theme(legend.position = "bottom",
        panel.grid.major.x = element_blank())
```

```{r bench-plot-scaling, fig.height=4, fig.width=8}
kimma_med <- sum_kimma$median

ggplot(sum_glme, aes(x = n_contrasts, y = median)) +
  geom_ribbon(aes(ymin = lq, ymax = uq), alpha = 0.15, fill = "#2c7bb6") +
  geom_line(colour = "#2c7bb6", linewidth = 0.9) +
  geom_point(colour = "#2c7bb6", size = 3) +
  geom_hline(yintercept = kimma_med, colour = "#d7191c",
             linetype = "dashed", linewidth = 0.8) +
  annotate("text", x = 66, y = kimma_med, vjust = -0.7, hjust = 1,
           colour = "#d7191c", size = 3.5, label = "kimma (66 contrasts)") +
  scale_x_continuous(breaks = c(3, 6, 66)) +
  labs(
    title    = "geneLME runtime scaling with number of contrasts",
    subtitle = "Shaded band = lower/upper quartile | Dashed red = kimma at 66 contrasts",
    x = "Number of contrasts", y = "Median runtime (seconds)"
  ) +
  theme_bw(base_size = 12)
```

## 2c. Speed summary table

```{r bench-table}
kimma_med <- sum_kimma$median

kable(
  bench_all %>%
    mutate(
      speedup_vs_kimma = round(kimma_med / median, 2),
      across(c(min, lq, median, mean, uq, max), ~ round(., 1))
    ) %>%
    select(
      Method        = version,
      `N contrasts` = n_contrasts,
      Min           = min,
      Q1            = lq,
      Median        = median,
      Q3            = uq,
      `Speedup vs kimma (66 contrasts)` = speedup_vs_kimma
    ),
  caption = "Runtime summary (seconds) — 2,000 genes, 5 repetitions",
  na_string = "—"
)
```

---

# 3. Summary

```{r final-summary}
n_same    <- nrow(joined_fwd)
n_flip    <- nrow(joined_flip)
n_total   <- nrow(joined_all)
pct_agree <- 100 * n_same / n_total

speedup_3  <- kimma_med / sum_glme$median[sum_glme$n_contrasts == 3]
speedup_6  <- kimma_med / sum_glme$median[sum_glme$n_contrasts == 6]
speedup_66 <- kimma_med / sum_glme$median[sum_glme$n_contrasts == 66]

cat(sprintf(
"=== SIGN CONSISTENCY (geneLME vs kimma) ===
  %d / %d (%.1f%%) gene×contrast pairs: same ref/lvl direction
  %d / %d (%.1f%%) pairs: kimma has direction flipped relative to contrast_spec
  After direction correction — estimate r = %.8f, MAD = %.2e

=== SPEED (2,000 genes, 8 cores, 5 reps) ===
  geneLME  3 contrasts median: %.1f s  (%.2fx %s than kimma at 66)
  geneLME  6 contrasts median: %.1f s  (%.2fx %s than kimma at 66)
  geneLME 66 contrasts median: %.1f s  (%.2fx %s than kimma at 66)
  kimma   66 contrasts median: %.1f s",
  n_same, n_total, pct_agree,
  n_flip, n_total, 100 - pct_agree,
  cor_all, mad_all,
  sum_glme$median[sum_glme$n_contrasts == 3],
  speedup_3,  ifelse(speedup_3  > 1, "faster", "slower"),
  sum_glme$median[sum_glme$n_contrasts == 6],
  speedup_6,  ifelse(speedup_6  > 1, "faster", "slower"),
  sum_glme$median[sum_glme$n_contrasts == 66],
  speedup_66, ifelse(speedup_66 > 1, "faster", "slower"),
  kimma_med
))
```

---

# Session Info

```{r session-info}
sessionInfo()
```
